<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="author" content="Guru Devanla">
        <title>Phantom Types</title>

        <!--web fonts-->
        <link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css">
        <link href="http://fonts.googleapis.com/css?family=Belgrano" rel="stylesheet" type="text/css">

        <link rel="stylesheet" href="/theme/css/main.css" />
        <!-- <link rel="stylesheet" href="/theme/css/pygment.css"/> -->
        <link rel="stylesheet" href="/theme/css/default.css"/>


           <script type="text/javascript">

               var _gaq = _gaq || [];
                 _gaq.push(['_setAccount', 'UA-45968778-1']);
                 _gaq.push(['_trackPageview']);

                 (function() {
                   var ga = document.createElement('script'); ga.type =
                   'text/javascript'; ga.async = true;
                   ga.src = ('https:' == document.location.protocol ?
                   'https://ssl' : 'http://www') +
                   '.google-analytics.com/ga.js';
                   var s = document.getElementsByTagName('script')[0];
                   s.parentNode.insertBefore(ga, s);
                 })();

               </script>

        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
              Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-45968778-2', 'gdevanla.github.io');
              ga('send', 'pageview');

        </script>
</head>

<body>
    <header>
        <span><a class="title" href="/index.html"><h1>blog <| code </h1></a></span>
        <nav>
            <ul>
                    <li><a href="/index.html">posts</a></li>
                    <li><a href="/archives.html">archives</a></li>
                    <li><a href="/pages/who-am-i.html">about</a></li>
                    <li><a href="/pages/books.html">book</a></li>
            </ul>
        </nav>
    </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h2>
        <a class="title" href="/drafts/phantom-types-in-haskell.html" rel="bookmark"
           title="Permalink to Phantom Types">Phantom Types</a></h2>
      <div class="extra-info">
                <abbr class="published" title="2016-09-12T21:28:35.195796-07:00">
                    09-12-2016
                </abbr>
                In <a href="/category/functional-programming-haskell-data-structures.html">functional programming, Haskell, data-structures</a>.       </div><!-- /.entry-content -->

    </header>
    <p>This is part of a mini-series documenting, what I believe are some
essential features of Haskell that are important to produce well
structured programs.</p>
<p>Phantom-types are a construct that can be built using parametric
polymoprhism. Phantom-types help us tag information about an type
during its creation and during type checking. This information is
thrown away by the compiler during runtime.</p>
<p>Phantom-types can also be used to create smart constructors, or create
objects that transition from be incomplete to complete objects that
can be used later on during the execution.</p>
<p>In the below example, say we have a record type called</p>
<div class="highlight"><pre><span></span>    <span class="kr">data</span> <span class="kt">GhostOrIllusion</span> <span class="ow">=</span>  <span class="kt">Ghost</span> <span class="o">|</span> <span class="kt">Illusion</span>
    <span class="kr">data</span> <span class="kt">MyPhantomType</span> <span class="ow">=</span> <span class="kt">MyPhantomType</span> <span class="p">{</span><span class="n">currentState</span><span class="ow">::</span><span class="kt">String</span><span class="p">,</span> <span class="n">phantomType</span><span class="ow">::</span><span class="kt">GhostOrIllusion</span><span class="p">}</span>
         <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">)</span>
</pre></div>


<p>Now, say we want functions only to accept an instance of</p>
<p><code>MyPhantomType</code> that has <code>phantomType</code> set to
<code>Illusion</code>. That is, we want functions defined as</p>
<div class="highlight"><pre><span></span>    <span class="n">usePhantomType</span> <span class="ow">::</span> <span class="kt">MyPhantomType</span> <span class="kt">Illusion</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
    <span class="n">usePhantomType</span> <span class="n">a</span> <span class="ow">=</span> <span class="s">&quot;Now I can use the Phantom Type &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">a</span>
</pre></div>


<p>We can try is to parameterize the record type, like</p>
<div class="highlight"><pre><span></span>    <span class="kr">data</span> <span class="kt">GhostOrIllusion</span> <span class="ow">=</span>  <span class="kt">Ghost</span> <span class="o">|</span> <span class="kt">Illusion</span>
    <span class="kr">data</span> <span class="kt">MyPhantomType</span> <span class="n">a</span> <span class="ow">=</span> <span class="kt">MyPhantomType</span> <span class="p">{</span><span class="n">currentState</span><span class="ow">::</span><span class="kt">String</span><span class="p">,</span> <span class="n">phantomType</span><span class="ow">::</span><span class="n">a</span><span class="p">}</span>
         <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">)</span>
</pre></div>


<p>But, even then you can only define functions such as</p>
<div class="highlight"><pre><span></span>    <span class="n">usePhantomType</span> <span class="ow">::</span> <span class="kt">MyPhantomType</span> <span class="kt">GhostOrIllusion</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
</pre></div>


<p>That is you cannot use value constructors, <code>Ghost</code> or
<code>Illusion</code>. Using phantom-types becomes a useful trick in such
situations.</p>
<div class="highlight"><pre><span></span>    <span class="kr">data</span> <span class="kt">Ghost</span>
    <span class="kr">data</span> <span class="kt">Illusion</span>
    <span class="kr">data</span> <span class="kt">MyPhantomType</span> <span class="n">a</span> <span class="ow">=</span> <span class="kt">MyPhantomType</span> <span class="p">{</span><span class="n">currentState</span><span class="ow">::</span><span class="kt">String</span><span class="p">}</span> <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">)</span>

    <span class="n">usePhantomType</span> <span class="ow">::</span> <span class="kt">MyPhantomType</span> <span class="kt">Illusion</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
    <span class="n">usePhantomType</span> <span class="n">a</span> <span class="ow">=</span> <span class="s">&quot;Now I can use the Phantom Type &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">a</span>
</pre></div>


<p>To create phantom types, again we can just take the help of the
runtime.</p>
<div class="highlight"><pre><span></span>    <span class="n">updateBelief</span> <span class="ow">::</span> <span class="kt">MyPhantomType</span> <span class="kt">Ghost</span> <span class="ow">-&gt;</span> <span class="kt">MyPhantomType</span> <span class="kt">Illusion</span>
    <span class="n">updateBelief</span> <span class="n">a</span> <span class="ow">=</span> <span class="n">a</span> <span class="p">{</span><span class="n">currentState</span><span class="ow">=</span><span class="s">&quot;nomoreafraid&quot;</span><span class="p">}</span>

    <span class="n">createPhantomType</span> <span class="ow">::</span> <span class="kt">String</span> <span class="ow">-&gt;</span> <span class="kt">MyPhantomType</span> <span class="kt">Ghost</span>
    <span class="n">createPhantomType</span> <span class="n">n</span> <span class="ow">=</span> <span class="kt">MyPhantomType</span> <span class="p">{</span><span class="n">currentState</span><span class="ow">=</span><span class="n">n</span><span class="p">}</span>

    <span class="kr">let</span> <span class="n">p</span> <span class="ow">=</span> <span class="n">usePhantomType</span> <span class="o">$</span> <span class="n">updateBelief</span> <span class="o">$</span> <span class="n">createPhantomType</span> <span class="s">&quot;afraid&quot;</span>
</pre></div>


<p>Let's quickly walk through what we did that. We first call
<code>createPhantomtype</code> method that will create a <code>Ghost</code> type for
us. But, we want our functions to only work on <code>Illusion</code>. That is
at some point in our program we will our belieft is going to transform
from <code>Ghost</code> to <code>Illusion</code> and or <code>Illusion</code> based
functions start to get called. We use the 'smart constructor'
<code>updateBelief</code> that will create the transition from <code>Ghost</code> to
<code>Illusion</code>.  Note that in our record creation we have not
specified the type. The record instance is created with the
appropriate type based on the return value of the function. For
example, in <code>updateBelief</code>, we just update the attribute of passed
in object. But, the runtime rightly return an instance of
<code>MyPhantonType</code> but with <code>Illusion</code> tagged on to it. That
enables us to make a call to <code>usePhantomType</code> that only accepts
<code>MyPhantomType Illusioion</code>.</p>
<p>Note that we use types here only to define functions that are tightly
tied to the types. We were able to move an attribute from record into
its type signature, and use that information to create functions that
work on specific types. Also, note, that this definition, does not
stop us from using the generic types in other functions, such as</p>
<div class="highlight"><pre><span></span>        <span class="n">useBothPhantomTypes</span> <span class="ow">::</span> <span class="kt">MyPhantomType</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="kt">String</span>
        <span class="n">useBothPhantomTypes</span> <span class="n">a</span> <span class="ow">=</span> <span class="n">show</span> <span class="n">a</span>
</pre></div>


<p>This function will accept both <code>Ghost</code> or <code>Illusion</code> instances
of MyPhantomType. In fact, it does not care what the value of <code>a</code>
is here. It could be any arbitrary type. In a future post, we will
look at higher kinds, that will help us restrict the type use to
create this record to just a few.</p>


  </article>
</section>
    <footer>
        <hr>
        <div class="social">
            <ul>
                <li><a href="http://github.com/gdevanla">GitHub</a></li>
                <li><a href="http://twitter.com/grdvnl">Twitter</a></li>
            </ul>
            <ul>
                <li>
                    Powered by Pelican
                </li>
            </ul>
        </div><!-- /.social -->


<!--  -->

</body>
</html>